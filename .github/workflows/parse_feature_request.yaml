name: Parse Feature Request

on:
  issues:
    types:
      - opened

jobs:
  parse-feature-request:
    runs-on: ubuntu-latest

    steps:
      - name: Log Issue Body
        run: |
          echo "Issue Body:"
          echo "${{ github.event.issue.body }}"

      - name: Parse Feature Request Details
        id: parse-details
        run: |
          issue_body="${{ github.event.issue.body }}"

          # Parse fields from the issue body
          feature_name=$(echo "$issue_body" | awk '/### Feature Name/{getline; print $0}' | xargs)
          feature_description=$(echo "$issue_body" | awk '/### Feature Description/{getline; print $0}' | xargs)
          motivation=$(echo "$issue_body" | awk '/### Motivation/{getline; print $0}' | xargs)
          potential_solutions=$(echo "$issue_body" | awk '/### Potential Solutions/{getline; print $0}' | xargs)
          impact_area=$(echo "$issue_body" | awk '/### Affected Areas/{getline; print $0}' | xargs)
          priority=$(echo "$issue_body" | awk '/### Priority/{getline; print $0}' | xargs)
          required_files=$(echo "$issue_body" | awk '/### Required Files/{getline; while($0 ~ /- \[ \]/) { print; getline }}' | xargs)


          echo "Feature Name: $feature_name"
          echo "Feature Description: $feature_description"
          echo "Motivation: $motivation"
          echo "Potential Solutions: $potential_solutions"
          echo "Impact Area: $impact_area"
          echo "Priority: $priority"
          echo "Required Files: $required_files"

          # Write outputs to GITHUB_OUTPUT
          echo "feature_name=$feature_name" >> $GITHUB_OUTPUT
          echo "feature_description=$feature_description" >> $GITHUB_OUTPUT
          echo "motivation=$motivation" >> $GITHUB_OUTPUT
          echo "potential_solutions=$potential_solutions" >> $GITHUB_OUTPUT
          echo "impact_area=$impact_area" >> $GITHUB_OUTPUT
          echo "priority=$priority" >> $GITHUB_OUTPUT
          echo "required_files=$required_files" >> $GITHUB_OUTPUT

      - name: Display Parsed Values
        run: |
          echo "Feature Name: ${{ steps.parse-details.outputs.feature_name }}"
          echo "Feature Description: ${{ steps.parse-details.outputs.feature_description }}"
          echo "Motivation: ${{ steps.parse-details.outputs.motivation }}"
          echo "Potential Solutions: ${{ steps.parse-details.outputs.potential_solutions }}"
          echo "Impact Area: ${{ steps.parse-details.outputs.impact_area }}"
          echo "Priority: ${{ steps.parse-details.outputs.priority }}"
          echo "Required Files: ${{ steps.parse-details.outputs.required_files }}"
